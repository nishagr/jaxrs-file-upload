package com.gs.utils;

import java.util.List;
import java.util.concurrent.BlockingQueue;
import java.util.concurrent.LinkedBlockingQueue;

import com.gs.models.RequestInfo;

public abstract class FileHandler implements Runnable {

	private BlockingQueue<List<String>> queue;
	protected boolean isActive;
	protected RequestInfo requestInfo;

	protected FileHandler() {
		isActive = true;
		queue = new LinkedBlockingQueue<>(10);
	}

	public void addToQueue(List<String> row) throws InterruptedException {
		System.out.println("Adding To Queue");
		queue.put(row);
	}

	public List<String> take() throws InterruptedException {
		System.out.println("Taking From Queue");
		return queue.take();
	}

	public boolean isQueueEmpty() {
		return queue.isEmpty();
	}

	public abstract void readFile();

	@Override
	public void run() {
		// TODO Auto-generated method stub
		System.err.println(requestInfo.getFileName() + " Processing Started");
		while (isActive) {
			try {
				List<String> record = queue.take();
				Thread.sleep(1000);
				for (String i : record)
					System.out.print(" | " + i);
				System.out.println(" |");
			} catch (InterruptedException e) {
				e.printStackTrace();
			}
		}
		System.err.println(requestInfo.getFileName() + " Processing Finished");
	}

}
